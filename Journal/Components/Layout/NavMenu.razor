@using Journal.Services
@using Journal.Models
@inject AuthService AuthService
@inject NavigationManager NavigationManager

<div class="app-sidebar">
    <div class="app-sidebar-header">
        <div class="app-user-info">
            <div class="app-user-avatar">
                @GetUserInitials()
            </div>
            <div class="app-user-details">
                <span class="app-user-name">@(currentUser?.FullName ?? "Guest")</span>
                <span class="app-user-id">ID: @currentUser?.Id</span>
            </div>
        </div>
    </div>
    <nav class="app-sidebar-nav">
        <ul class="app-sidebar-list">
            <li class="app-sidebar-item">
                <a href="/dashboard" class="app-sidebar-link" @onclick='() => Navigate("/dashboard")' >
                    <i class="fa-solid fa-chart-line"></i>
                    <span class="app-sidebar-text">Dashboard</span>
                </a>
            </li>
            <li class="app-sidebar-item">
                <a href="/journal/list" class="app-sidebar-link" @onclick='() => Navigate("/journal/list")'>
                    <i class="fa-solid fa-book"></i>
                    <span class="app-sidebar-text">Journals</span>
                </a>
            </li>
            <li class="app-sidebar-item">
                <a href="/journal/add" class="app-sidebar-link" @onclick='() => Navigate("/journal/add")'>
                    <i class="fa-solid fa-plus"></i>
                    <span class="app-sidebar-text">New Entry</span>
                </a>
            </li>
        </ul>
    </nav>
</div>

@code {
    private User? currentUser;

    protected override void OnInitialized()
    {
        currentUser = AuthService.GetCurrentUser();
    }

    private void Navigate(string path)
    {
        NavigationManager.NavigateTo(path);
    }

    private string GetUserInitials()
    {
        if (currentUser?.FullName == null) return "?";
        var parts = currentUser.FullName.Split(' ', StringSplitOptions.RemoveEmptyEntries);
        if (parts.Length >= 2)
        {
            return $"{parts[0][0]}{parts[1][0]}".ToUpper();
        }
        return currentUser.FullName.Length > 0 ? currentUser.FullName[0].ToString().ToUpper() : "?";
    }

    
}